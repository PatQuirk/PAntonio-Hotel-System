CREATE TABLE Employees
(
  EmpID INT NOT NULL AUTO_INCREMENT,
  EmpName VARCHAR(250) NOT NULL,
  EmpStartDate DATE NOT NULL,
  PRIMARY KEY (EmpID),
  EmpEndDate DATE CHECK (EmpStartDate < EmpEndDate)
);

CREATE TABLE Customers
(
  CustID INT NOT NULL AUTO_INCREMENT,
  CustFirst VARCHAR(250) NOT NULL,
  CustLast VARCHAR(250) NOT NULL,
  CustBalance INT NOT NULL DEFAULT 30,
  PRIMARY KEY (CustID)
);

CREATE TABLE Buildings
(
  BuildID INT NOT NULL AUTO_INCREMENT,
  BuildName VARCHAR(250) NOT NULL,
  PRIMARY KEY (BuildID)
);

CREATE TABLE Login
(
  UserName VARCHAR(250) NOT NULL,
  PassWord VARCHAR(250) NOT NULL,
  PosName VARCHAR(250) NOT NULL,
  EmpID INT DEFAULT NULL,
  CustID INT DEFAULT NULL,
  PRIMARY KEY (UserName),
  FOREIGN KEY (EmpID) REFERENCES Employees(EmpID) ON DELETE SET NULL ON UPDATE CASCADE,
  FOREIGN KEY (CustID) REFERENCES Customers(CustID) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE Maintenance
(
  MintType VARCHAR(250) NOT NULL,
  MintID INT NOT NULL AUTO_INCREMENT,
  EmpID INT DEFAULT NULL,
  PRIMARY KEY (MintID),
  FOREIGN KEY (EmpID) REFERENCES Employees(EmpID) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE Rooms
(
  RoomID INT NOT NULL AUTO_INCREMENT,
  Available VARCHAR(250) NOT NULL DEFAULT 'YES',
  Price FLOAT NOT NULL DEFAULT 30,
  BuildID INT NOT NULL,
  PRIMARY KEY (RoomID, BuildID),
  FOREIGN KEY (BuildID) REFERENCES Buildings(BuildID) ON DELETE CASCADE ON UPDATE CASCADE,
  CHECK(Price>30)
);

CREATE TABLE need
(
  Description VARCHAR(250) NOT NULL,
  MintID INT NOT NULL,
  RoomID INT NOT NULL,
  BuildID INT NOT NULL,
  PRIMARY KEY (MintID, RoomID, BuildID),
  FOREIGN KEY (MintID) REFERENCES Maintenance(MintID),
  FOREIGN KEY (RoomID, BuildID) REFERENCES Rooms(RoomID, BuildID)
);


CREATE TABLE Customers_CustPhone
(
  CustPhone BIGINT,
  CustID INT,
  PRIMARY KEY (CustPhone, CustID),
  FOREIGN KEY (CustID) REFERENCES Customers(CustID) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE Employees_EmpPhone
(
  EmpPhone BIGINT,
  EmpID INT,
  PRIMARY KEY (EmpPhone, EmpID),
  FOREIGN KEY (EmpID) REFERENCES Employees(EmpID) ON DELETE CASCADE ON UPDATE CASCADE
);


CREATE TABLE Reservations
(
  ResID INT NOT NULL AUTO_INCREMENT,
  EmpID INT DEFAULT NULL,
  CustID INT DEFAULT NULL,
  RoomID INT NOT NULL,
  BuildID INT NOT NULL,
  DateFrom DATE NOT NULL,
  DateTo DATE NOT NULL,
  CheckedOut varchar(3) NOT NULL,
  PRIMARY KEY (ResID),
  FOREIGN KEY (EmpID) REFERENCES Employees(EmpID) ON DELETE SET NULL ON UPDATE CASCADE,
  FOREIGN KEY (CustID) REFERENCES Customers(CustID) ON DELETE SET NULL ON UPDATE CASCADE,
  FOREIGN KEY (RoomID, BuildID) REFERENCES Rooms(RoomID, BuildID)
);






CREATE INDEX EmpNameINDEX
ON employees (EmpName);

CREATE INDEX CustNameINDEX
ON customers (CustFirst);

CREATE INDEX RoomNumINDEX
ON rooms (RoomID);
